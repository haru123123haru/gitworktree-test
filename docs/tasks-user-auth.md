# ユーザー認証機能 タスクリスト

**ブランチ名:** `feature/user-auth`
**worktree:** `main-auth`
**優先度:** 高

---

## 概要

ユーザー登録・ログイン機能を実装し、タスクをユーザーごとに管理できるようにする。

---

## タスク一覧

### 1. データモデルの設計・実装

- [ ] ユーザーデータの構造設計
  - id, email, passwordHash, createdAt
- [ ] `src/data/users.json` ファイル作成
- [ ] タスクデータにuserIdフィールドを追加

### 2. バックエンド実装

#### 2.1 ユーザー登録 API
- [ ] `POST /api/auth/register` エンドポイント作成
- [ ] メールアドレスのバリデーション
- [ ] パスワードのハッシュ化（bcrypt使用）
- [ ] 重複メールアドレスのチェック
- [ ] ユーザー作成処理

#### 2.2 ログイン API
- [ ] `POST /api/auth/login` エンドポイント作成
- [ ] メールアドレス・パスワードの検証
- [ ] JWT トークン生成
- [ ] トークンをレスポンスで返却

#### 2.3 ログアウト API
- [ ] `POST /api/auth/logout` エンドポイント作成
- [ ] クライアント側でトークン削除の指示

#### 2.4 認証ミドルウェア
- [ ] JWT 検証ミドルウェア作成
- [ ] 既存のタスクAPIに認証を適用
- [ ] タスク取得時にuserIdでフィルタリング

### 3. フロントエンド実装

#### 3.1 認証UI
- [ ] ログインフォーム作成
- [ ] ユーザー登録フォーム作成
- [ ] ログイン/登録の切り替えUI

#### 3.2 認証状態管理
- [ ] トークンのLocalStorage保存
- [ ] ログイン状態の判定処理
- [ ] ヘッダーにログインユーザー情報表示
- [ ] ログアウトボタン実装

#### 3.3 API連携
- [ ] fetch リクエストに Authorization ヘッダー追加
- [ ] 401エラー時のログイン画面リダイレクト

### 4. テスト・検証

- [ ] ユーザー登録の動作確認
- [ ] ログイン/ログアウトの動作確認
- [ ] 認証済みユーザーのみタスク操作可能か確認
- [ ] 他ユーザーのタスクが見えないか確認

### 5. ドキュメント

- [ ] API仕様書の更新
- [ ] 使用方法のREADME追記

---

## 依存パッケージ

```bash
npm install bcrypt jsonwebtoken
```

---

## 完了条件

- [ ] 新規ユーザーが登録できる
- [ ] 登録済みユーザーがログインできる
- [ ] ログイン中のみタスク操作が可能
- [ ] 自分のタスクのみ表示される
- [ ] ログアウトが正常に動作する
