# 期限管理機能 タスクリスト

**ブランチ名:** `feature/deadline`
**worktree:** `main-deadline`
**優先度:** 高

---

## 概要

タスクに期限を設定し、期限切れや期限間近のタスクを視覚的に強調表示する。
また、期限や作成日でのソート機能を追加する。

---

## タスク一覧

### 1. データモデルの拡張

- [ ] タスクデータに `deadline` フィールド追加
- [ ] 既存タスクデータのマイグレーション（deadline: null）
- [ ] tasks.json のスキーマ更新

### 2. バックエンド実装

#### 2.1 API更新
- [ ] タスク作成APIで deadline を受け付ける
- [ ] タスク更新APIで deadline を変更可能に
- [ ] 期限のバリデーション（過去日付の扱い決定）

#### 2.2 ソートAPI
- [ ] `GET /api/tasks?sort=deadline` 対応
- [ ] `GET /api/tasks?sort=createdAt` 対応
- [ ] `GET /api/tasks?sort=status` 対応
- [ ] 昇順/降順の対応（order=asc/desc）

### 3. フロントエンド実装

#### 3.1 期限入力UI
- [ ] タスク作成フォームに日付ピッカー追加
- [ ] タスク編集モーダルに日付ピッカー追加
- [ ] 期限クリアボタンの実装

#### 3.2 期限表示
- [ ] タスク一覧に期限を表示
- [ ] 期限切れタスクの強調表示（赤色）
- [ ] 期限間近タスク（24時間以内）の強調表示（オレンジ）
- [ ] 残り時間の表示（例: "あと2日"）

#### 3.3 ソート機能UI
- [ ] ソート選択ドロップダウン追加
- [ ] ソート順切り替えボタン
- [ ] 現在のソート状態の表示

#### 3.4 ソートロジック
- [ ] クライアント側ソート処理の実装
- [ ] ソート状態の管理
- [ ] ソート変更時の再描画

### 4. スタイリング

- [ ] 日付ピッカーのスタイル調整
- [ ] 期限切れスタイル（.task-overdue）
- [ ] 期限間近スタイル（.task-due-soon）
- [ ] ソートUIのスタイル

### 5. テスト・検証

- [ ] 期限付きタスクの作成確認
- [ ] 期限の編集・削除確認
- [ ] 期限切れ表示の確認
- [ ] 期限間近表示の確認
- [ ] 各種ソートの動作確認
- [ ] 日付のタイムゾーン処理確認

---

## 日付処理の注意点

```javascript
// 期限切れ判定
function isOverdue(deadline) {
  if (!deadline) return false;
  return new Date(deadline) < new Date();
}

// 期限間近判定（24時間以内）
function isDueSoon(deadline) {
  if (!deadline) return false;
  const now = new Date();
  const due = new Date(deadline);
  const diff = due - now;
  return diff > 0 && diff < 24 * 60 * 60 * 1000;
}
```

---

## 完了条件

- [ ] タスクに期限を設定できる
- [ ] 期限切れタスクが赤色で表示される
- [ ] 期限間近タスクがオレンジ色で表示される
- [ ] 期限順・作成日順・ステータス順でソートできる
- [ ] 昇順/降順を切り替えられる
